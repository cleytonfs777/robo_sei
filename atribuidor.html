<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SDTS - Gerador de Despacho</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .header {
            background-color: #081d33;
            color: #ffffff;
            padding: 15px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 20px;
            font-weight: normal;
        }

        .form-container {
            background-color: #f5f5f5;
            padding: 20px;
            border-radius: 0 0 15px 15px;
        }

        .form-row {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .form-group {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        label {
            color: #1664B8;
            font-size: 13px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        input[type="text"],
        textarea,
        select {
            padding: 10px;
            border: 1px solid transparent;
            border-radius: 6px;
            font-size: 13px;
            background-color: #ebebeb;
            color: #081d33;
        }

        textarea {
            resize: vertical;
            min-height: 60px;
        }

        select {
            background-color: #081d33;
            color: #ffffff;
            padding: 12px;
            font-weight: bold;
        }

        .documento-row {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .documento-row select {
            width: 100px;
        }

        .documento-row input {
            flex: 3;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
        }

        .btn-add {
            background-color: #1664B8;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 24px;
        }

        .btn-add:hover {
            background-color: #0d4a8a;
        }

        .btn-primary {
            background-color: #1664B8;
            color: white;
        }

        .btn-primary:hover {
            background-color: #0d4a8a;
        }

        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background-color: #545b62;
        }

        .lista-documentos {
            background-color: #081d33;
            border-radius: 6px;
            padding: 10px;
            min-height: 100px;
            max-height: 200px;
            overflow-y: auto;
            margin-bottom: 15px;
        }

        .documento-item {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 8px;
            margin-bottom: 5px;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
        }

        .btn-delete {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .btn-delete:hover {
            background-color: #c82333;
        }

        .resultado-container {
            margin-top: 15px;
        }

        .texto-resultado {
            background-color: #ebebeb;
            border-radius: 6px;
            padding: 15px;
            position: relative;
        }

        .texto-resultado textarea {
            width: 100%;
            min-height: 120px;
            background-color: transparent;
            border: none;
            resize: none;
            font-size: 15px;
        }

        .contador {
            position: absolute;
            bottom: 10px;
            right: 15px;
            font-size: 13px;
            color: #081d33;
            font-weight: bold;
        }

        .alert {
            padding: 15px;
            border-radius: 6px;
            margin-top: 10px;
            text-align: center;
            font-weight: bold;
            display: none;
        }

        .alert-success {
            background-color: #95FF64;
            color: #111F02;
        }

        .alert-error {
            background-color: #FF6464;
            color: #1F0202;
        }

        .buttons-row {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>SDTS - Despacho</h1>
        </div>

        <div class="form-container">
            <div class="form-row">
                <div class="form-group">
                    <label for="assunto">Assunto</label>
                    <input type="text" id="assunto" placeholder="Digite o assunto">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="complemento">Complemento</label>
                    <input type="text" id="complemento" placeholder="Digite o complemento (opcional)">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="atribuicao">Atribuição</label>
                    <select id="atribuicao">
                        <option value="">Selecione...</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <label>Adicionar Documentos</label>
            </div>

            <div class="form-row documento-row">
                <select id="artigo">
                    <option value="o">o</option>
                    <option value="a">a</option>
                </select>
                <input type="text" id="nomeDocumento" placeholder="Nome do documento">
                <button class="btn-add" onclick="adicionarDocumento()">+</button>
            </div>

            <div class="lista-documentos" id="listaDocumentos">
                <!-- Documentos adicionados aparecerão aqui -->
            </div>

            <div class="buttons-row">
                <button class="btn-primary" onclick="gerarTexto()">Gerar Texto</button>
                <button class="btn-secondary" onclick="limparCampos()">Limpar</button>
            </div>

            <div class="resultado-container">
                <div class="texto-resultado">
                    <label>Texto Final</label>
                    <textarea id="textoFinal" readonly></textarea>
                    <span class="contador" id="contador">0/250</span>
                </div>
            </div>

            <div class="alert alert-success" id="alertSuccess">Texto Válido!</div>
            <div class="alert alert-error" id="alertError">Texto Inválido - Excede 250 caracteres</div>
        </div>
    </div>

    <script>
        // Lista específica de atribuições
        const listaAtribuicoes = [
            "Ten Paiva",
            "Maj Vicente",
            "Maj Couto",
            "Maj Giovanny",
            "Cap Linke",
            "Cap Alexandre",
            "Sgt Damásio",
            "Sgt Sandro",
            "Ten Cesar Alves",
            "Cel Stella",
            "Ten Cel Montezano"
        ];

        let documentos = [];

        // Função para determinar o tratamento inicial (Sr./Sra.)
        function getTratamentoInicial(nome) {
            // Caso específico: Cel Stella deve ser Sra.
            if (nome === "Cel Stella") {
                return "Sra.";
            }
            // Verificar postos superiores (Maj, Ten Cel, Cel) - usar Sr.
            else if (nome.startsWith("Maj ") || nome.startsWith("Ten Cel ") || nome.startsWith("Cel ")) {
                return "Sr.";
            }
            // Para os demais postos não precisa de tratamento
            else {
                return "";
            }
        }

        // Função para determinar a despedida baseada no posto
        function getDespedida(nome) {
            // Verificar postos superiores (Maj, Ten Cel, Cel)
            if (nome.startsWith("Maj ") || nome.startsWith("Ten Cel ") || nome.startsWith("Cel ")) {
                return "Resp,";
            }
            // Verificar postos intermediários/praças (Sd, Cb, Sgt, Ten)
            else if (nome.startsWith("Sd ") || nome.startsWith("Cb ") || nome.startsWith("Sgt ") || nome.startsWith("Ten ")) {
                return "Att,";
            }
            // Outros casos
            else {
                return "Cord,";
            }
        }

        // Carregar lista de atribuições
        function carregarAtribuicoes() {
            const select = document.getElementById('atribuicao');
            
            listaAtribuicoes.forEach(nome => {
                const option = document.createElement('option');
                option.value = nome;
                option.textContent = nome;
                select.appendChild(option);
            });

            // Definir valor padrão
            select.value = "Maj Giovanny";
        }

        function adicionarDocumento() {
            const artigo = document.getElementById('artigo').value;
            const nomeDoc = document.getElementById('nomeDocumento').value.trim();

            if (!nomeDoc) {
                alert('Digite o nome do documento');
                return;
            }

            const documento = `${artigo} ${nomeDoc}`;
            documentos.push(documento);
            atualizarListaDocumentos();

            // Limpar campos
            document.getElementById('nomeDocumento').value = '';
        }

        function atualizarListaDocumentos() {
            const lista = document.getElementById('listaDocumentos');
            lista.innerHTML = '';

            documentos.forEach((doc, index) => {
                const div = document.createElement('div');
                div.className = 'documento-item';
                div.innerHTML = `
                    <span>${doc}</span>
                    <button class="btn-delete" onclick="removerDocumento(${index})">Excluir</button>
                `;
                lista.appendChild(div);
            });
        }

        function removerDocumento(index) {
            documentos.splice(index, 1);
            atualizarListaDocumentos();
        }

        function formatarItens(lista) {
            if (lista.length === 1) {
                return lista[0];
            } else if (lista.length === 2) {
                return `${lista[0]} e ${lista[1]}`;
            } else {
                return lista.slice(0, -1).join(', ') + ' e ' + lista[lista.length - 1];
            }
        }

        function gerarTexto() {
            const atribuicao = document.getElementById('atribuicao').value;
            const assunto = document.getElementById('assunto').value.trim();
            const complemento = document.getElementById('complemento').value.trim();

            if (!atribuicao || !assunto) {
                alert('Preencha os campos obrigatórios: Atribuição e Assunto');
                return;
            }

            if (documentos.length === 0) {
                alert('Adicione pelo menos um documento');
                return;
            }

            const tratamentoInicial = getTratamentoInicial(atribuicao);
            const stringOficios = formatarItens(documentos);
            const complementoTexto = complemento ? `${complemento}. ` : '';
            const tratamento = documentos.length === 1 ? 'trata' : 'tratam';
            const despedida = getDespedida(atribuicao);

            // Montar o texto inicial - sempre inclui o nome, com ou sem Sr./Sra.
            const inicioTexto = tratamentoInicial ? `${tratamentoInicial} ${atribuicao}. ` : `${atribuicao}. `;
            
            // Definir o texto de encaminhamento baseado no tratamento
            const textoEncaminhamento = tratamentoInicial ? 'Encaminho a V.Sa. para analise e despacho' : 'Encaminho para analise e despacho';

            const textoFinal = `${inicioTexto}${textoEncaminhamento} ${stringOficios}, que ${tratamento} de ${assunto}. ${complementoTexto}${despedida} Cap Cleyton.`;

            document.getElementById('textoFinal').value = textoFinal;
            atualizarContador(textoFinal);
        }

        function atualizarContador(texto) {
            const tamanho = texto.length;
            const contador = document.getElementById('contador');
            const alertSuccess = document.getElementById('alertSuccess');
            const alertError = document.getElementById('alertError');

            contador.textContent = `${tamanho}/250`;

            if (tamanho <= 250) {
                alertSuccess.style.display = 'block';
                alertError.style.display = 'none';
                contador.style.color = '#081d33';
            } else {
                alertSuccess.style.display = 'none';
                alertError.style.display = 'block';
                contador.style.color = '#dc3545';
            }
        }

        function limparCampos() {
            document.getElementById('assunto').value = '';
            document.getElementById('complemento').value = '';
            document.getElementById('nomeDocumento').value = '';
            document.getElementById('textoFinal').value = '';
            documentos = [];
            atualizarListaDocumentos();
            document.getElementById('contador').textContent = '0/250';
            document.getElementById('alertSuccess').style.display = 'none';
            document.getElementById('alertError').style.display = 'none';
        }

        // Carregar dados ao iniciar
        window.onload = function() {
            carregarAtribuicoes();
        };

        // Permitir adicionar documento ao pressionar Enter
        document.getElementById('nomeDocumento').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                adicionarDocumento();
            }
        });
    </script>
</body>
</html>
