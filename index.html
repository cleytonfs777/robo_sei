<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Criador de Of√≠cios - SEI</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>üî• Criador de Of√≠cios SEI</h1>
                <p>Sistema automatizado de cria√ß√£o de of√≠cios com IA</p>
            </div>
        </header>

        <main>
            <form id="oficioForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="doc_sei">
                            <span class="label-icon">üìÑ</span>
                            Documento SEI
                        </label>
                        <input 
                            type="text" 
                            id="doc_sei" 
                            name="doc_sei" 
                            placeholder="Ex: 126086248"
                            required
                        >
                    </div>

                    <div class="form-group">
                        <label for="processo">
                            <span class="label-icon">üìã</span>
                            N√∫mero do Processo
                        </label>
                        <input 
                            type="text" 
                            id="processo" 
                            name="processo" 
                            placeholder="Ex: 1400.01.0074829/2025-05"
                            required
                        >
                    </div>
                    <div class="form-group">
                        <label for="processo">
                            <span class="label-icon">üîç</span>
                            Of√≠cio de Refer√™ncia
                        </label>
                        <input 
                            type="text" 
                            id="ofreferencia" 
                            name="ofreferencia" 
                            placeholder="Ex: Of√≠cio 388 (126102548)"
                            required
                        >
                    </div>

                    <div class="form-group full-width">
                        <label for="assunto">
                            <span class="label-icon">üìù</span>
                            Assunto
                        </label>
                        <input 
                            type="text" 
                            id="assunto" 
                            name="assunto" 
                            placeholder="Ex: Resposta quanto a esclarecimentos adicionais"
                            required
                        >
                    </div>

                    <div class="form-group full-width">
                        <label for="complementar">
                            <span class="label-icon">üí°</span>
                            Complemento para IA (opcional)
                            <span class="label-hint">Instru√ß√µes adicionais para gera√ß√£o da resposta</span>
                        </label>
                        <textarea 
                            id="complementar" 
                            name="complementar" 
                            rows="2"
                            placeholder="Ex: Seja mais formal, mencione a legisla√ß√£o vigente, etc."
                        ></textarea>
                    </div>

                    <div class="form-group full-width">
                        <label for="destinatario">
                            <span class="label-icon">üë§</span>
                            Destinat√°rio
                        </label>
                        <input 
                            type="text" 
                            id="destinatario" 
                            name="destinatario" 
                            placeholder="Ex: Senhor Ten Cel BM, Resp p/ pelo 5¬∫COB"
                            required
                        >
                    </div>

                    <div class="form-group">
                        <label for="signatario">
                            <span class="label-icon">‚úçÔ∏è</span>
                            Signat√°rio
                        </label>
                        <select 
                            id="signatario" 
                            name="signatario"
                            required
                        >
                            <option value="">Selecione o signat√°rio...</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="graduacao">
                            <span class="label-icon">üéñÔ∏è</span>
                            Gradua√ß√£o
                        </label>
                        <input 
                            type="text" 
                            id="graduacao" 
                            name="graduacao" 
                            placeholder="Ex: Cel BM"
                            readonly
                            required
                        >
                    </div>

                    <div class="form-group full-width">
                        <label for="funcao">
                            <span class="label-icon">üíº</span>
                            Fun√ß√£o
                        </label>
                        <input 
                            type="text" 
                            id="funcao" 
                            name="funcao" 
                            placeholder="Ex: Diretora de Log√≠stica e Finan√ßas"
                            readonly
                            required
                        >
                    </div>
                </div>

                <!-- Se√ß√£o de Marca√ß√£o e Atribui√ß√£o -->
                <div class="section-header">
                    <h3>üìå Marca√ß√£o e Atribui√ß√£o</h3>
                    <p class="section-description">Configure a etiqueta e atribui√ß√£o do processo</p>
                </div>

                <div class="form-grid">
                    <div class="form-group full-width">
                        <label for="etiqueta">
                            <span class="label-icon">üè∑Ô∏è</span>
                            Etiqueta
                        </label>
                        <select 
                            id="etiqueta" 
                            name="etiqueta"
                            required
                        >
                            <option value="Aguardando Despacho Diretor">Aguardando Despacho Diretor</option>
                            <option value="Aguardando Despacho do Major">Aguardando Despacho do Major</option>
                            <option value="Aguardando Despacho do SDTS">Aguardando Despacho do SDTS</option>
                            <option value="Divulga√ß√£o Geral">Divulga√ß√£o Geral</option>
                            <option value="NTS">NTS</option>
                            <option value="Prioridade - Urgente">Prioridade - Urgente</option>
                        </select>
                    </div>

                    <div class="form-group full-width">
                        <label for="atribuicao">
                            <span class="label-icon">üë•</span>
                            Atribuir Para
                        </label>
                        <select 
                            id="atribuicao" 
                            name="atribuicao"
                            required
                        >
                        <option value="Cel Stella">Cel Stella</option>
                        <option value="Ten Cel Montezano">Ten Cel Montezano</option>
                        <option value="Maj Vicente">Maj Vicente</option>
                        <option value="Maj Rocha">Maj Rocha</option>
                        <option value="Maj Couto">Maj Couto</option>
                        <option value="Maj Giovanny" selected>Maj Giovanny</option>
                        <option value="Cap Linke">Cap Linke</option>
                        <option value="Cap Alexandre">Cap Alexandre</option>
                        <option value="Sgt Dam√°sio">Sgt Dam√°sio</option>
                        <option value="Sgt Sandro">Sgt Sandro</option>
                        <option value="Ten Cesar Alves">Ten Cesar Alves</option>
                        <option value="Ten Paiva">Ten Paiva</option>
                        </select>
                    </div>

                    <div class="form-group full-width">
                        <label for="msg">
                            <span class="label-icon">üí¨</span>
                            Mensagem da Anota√ß√£o
                            <button type="button" class="btn-helper" id="btnGerarMsg" title="Gerar mensagem automaticamente">
                                ‚ú® Gerar Despacho
                            </button>
                        </label>
                        <textarea 
                            id="msg" 
                            name="msg" 
                            rows="3"
                            placeholder="Digite a mensagem que ser√° adicionada como anota√ß√£o no processo..."
                            required
                        ></textarea>
                        <span class="char-counter" id="charCounter">0/250 caracteres</span>
                    </div>

                    <!-- Gerador de Despacho (oculto por padr√£o) -->
                    <div id="despachoGenerator" class="despacho-generator hidden">
                        <h4>üìã Gerador de Despacho</h4>
                        
                        <div class="form-group">
                            <label>Complemento (opcional)</label>
                            <input type="text" id="complemento" placeholder="Digite o complemento (opcional)">
                        </div>

                        <div class="form-grid" style="grid-template-columns: auto 1fr auto; align-items: end;">
                            <div class="form-group">
                                <label>Artigo</label>
                                <select id="artigo">
                                    <option value="o">o</option>
                                    <option value="a">a</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Nome do Documento</label>
                                <input type="text" id="nomeDocumento" placeholder="Ex: Of√≠cio n¬∫ 123/2025">
                            </div>
                            <div class="form-group">
                                <button type="button" class="btn-add-doc" id="btnAddDoc">+</button>
                            </div>
                        </div>
                        <div id="listaDocumentos" class="lista-docs"></div>
                        <div id="alertDespacho" class="alert-despacho hidden"></div>
                        <button type="button" class="btn-gerar" id="btnGerarTexto">‚ú® Gerar Texto</button>
                    </div>
                </div>

                <div class="button-group">
                    <button type="submit" id="submitBtn" class="btn btn-primary">
                        <span class="btn-icon">üöÄ</span>
                        Criar Of√≠cio
                    </button>
                    <button type="button" id="clearBtn" class="btn btn-secondary">
                        <span class="btn-icon">üîÑ</span>
                        Limpar
                    </button>
                </div>
            </form>

            <div id="statusContainer" class="status-container hidden">
                <div class="status-header">
                    <h2>üìä Status do Processo</h2>
                    <button id="closeStatus" class="close-btn">‚úï</button>
                </div>
                <div id="statusLog" class="status-log"></div>
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill">
                        <span id="progressText" class="progress-text">0%</span>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p>¬© 2025 CBMMG - Sistema de Cria√ß√£o Autom√°tica de Of√≠cios</p>
        </footer>
    </div>

    <script>
        // Carregar dados dos militares e popular o select de signat√°rio
        let dadosMilitares = {};
        
        fetch('/dadosmil.json')
            .then(response => response.json())
            .then(data => {
                dadosMilitares = data;
                const signatarioSelect = document.getElementById('signatario');
                
                // Popular o select com os nomes dos militares
                Object.entries(data).forEach(([cpf, dados]) => {
                    const option = document.createElement('option');
                    option.value = cpf;
                    option.textContent = dados[0]; // Nome completo (posi√ß√£o 0)
                    signatarioSelect.appendChild(option);
                });
            })
            .catch(error => console.error('Erro ao carregar dados dos militares:', error));
        
        // Evento de mudan√ßa do signat√°rio
        document.getElementById('signatario').addEventListener('change', function() {
            const cpf = this.value;
            if (cpf && dadosMilitares[cpf]) {
                const dados = dadosMilitares[cpf];
                // Posi√ß√£o 5 = Gradua√ß√£o (√≠ndice 5)
                document.getElementById('graduacao').value = dados[5] || '';
                // Posi√ß√£o 6 = Fun√ß√£o (√≠ndice 6)
                document.getElementById('funcao').value = dados[6] || '';
            } else {
                document.getElementById('graduacao').value = '';
                document.getElementById('funcao').value = '';
            }
        });
    </script>
    <script src="script.js"></script>
</body>
</html>
